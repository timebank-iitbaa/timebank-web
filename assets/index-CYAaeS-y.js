(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function o(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(n){if(n.ep)return;n.ep=!0;const r=o(n);fetch(n.href,r)}})();const I="https://script.google.com/macros/s/AKfycbzxY9Q27j0hkv8et8ZnY_Rg639FjD2jtMFFdXyhOZ-EPqH9dCNWjSPUXjISQnTZ8AQ/exec",T="239868878252-db1evisitvh535amajkvubl22kp0jcdm.apps.googleusercontent.com",N="62D8EAC6-9B68-4649-80EF-71FBC18D0D98",h=[{id:"career-professional-development",label:"Career & Professional Development",description:"Support students & other alumni with career decisions, resumes, interviews, leadership, and professional growth."},{id:"technical-domain-expertise",label:"Technical & Domain Expertise",description:"Share engineering, technology, and domain-specific knowledge across core IITB disciplines."},{id:"entrepreneurship-innovation",label:"Entrepreneurship & Innovation",description:"Mentor students and teams on startups, ideas, fundraising, and go-to-market thinking."},{id:"research-academia-support",label:"Research & Academia Support",description:"Guide research methodology, paper reviews, academic writing, guest lectures, and proposal development."},{id:"social-impact-sustainability",label:"Social Impact & Sustainability",description:"Contribute expertise to social entrepreneurship, NGOs, education, and sustainability projects."},{id:"life-skills-mindset",label:"Life Skills & Mindset",description:"Help build critical thinking, decision-making skills, teamwork, and personal resilience."},{id:"program-platform-roles",label:"Program & Platform Roles",description:"Participate as workshop leaders, co-designers of programs, and volunteers supporting TimeBank operations."}];let s=null,L=!1;const _=document.getElementById("view-landing"),l=document.getElementById("view-app"),q=document.querySelectorAll("[data-gsi-button]"),f=document.getElementById("busy-overlay"),y=document.getElementById("busy-message"),p=document.querySelector("[data-landing-nav]"),a=document.querySelector("[data-contrib-button]"),w=document.querySelector("[data-account-chip]"),b=document.querySelector("[data-account-email]"),S=document.querySelector("[data-signout]"),v=document.querySelector("[data-home]");document.querySelectorAll("[data-scroll]").forEach(e=>{e.addEventListener("click",t=>{const o=t.currentTarget.getAttribute("data-scroll"),i=document.querySelector(o);i&&i.scrollIntoView({behavior:"smooth"})})});v&&v.addEventListener("click",e=>{e.preventDefault(),O(),window.scrollTo({top:0,behavior:"smooth"})});a&&a.addEventListener("click",()=>{x(),window.scrollTo({top:0,behavior:"smooth"})});S&&S.addEventListener("click",()=>{s=null,sessionStorage.removeItem("timebank_token"),m(!1),O()});window.handleCredentialResponse=e=>{s=e.credential,sessionStorage.setItem("timebank_token",s),u(!0,"Signing you in…"),g("login_and_fetch_view",{}).then(k).catch(C).finally(()=>u(!1))};d();P();const E=sessionStorage.getItem("timebank_token");E?(s=E,u(!0,"Loading your dashboard…"),g("login_and_fetch_view",{}).then(k).catch(e=>{sessionStorage.removeItem("timebank_token"),m(!1),C(e)}).finally(()=>u(!1))):m(!1);function d(){if(window.google&&google.accounts&&google.accounts.id){google.accounts.id.initialize({client_id:T,callback:handleCredentialResponse,auto_select:!1,use_fedcm_for_prompt:!0}),q.forEach(e=>{const t=e.dataset.gsiSize||"large",o=e.dataset.gsiText||"continue_with",i=t==="medium"?160:260;google.accounts.id.renderButton(e,{type:"standard",size:t,width:i,theme:"outline",text:o,shape:"pill",logo_alignment:"left"})});return}if(d.attempts>30){console.error("Google Identity Services failed to load.");return}d.attempts+=1,setTimeout(d,250)}d.attempts=0;function k(e){if(e.error)throw new Error(e.error);if(!e.html)throw new Error("Missing app view");x();const t=document.createRange();t.selectNode(document.body);const o=t.createContextualFragment(e.html);l.innerHTML="",l.appendChild(o);const i=l.querySelector("#user-email");m(!0,i?i.textContent:B(s)),window.google=window.google||{},window.google.script={run:{withSuccessHandler:n=>({withFailureHandler:r=>({proxyApiCall:(c,A)=>{g(c,A).then(n).catch(r)}})})}}}async function g(e,t){const o={action:e,sharedKey:N,credential:s,...t},n=await(await fetch(I,{method:"POST",body:JSON.stringify(o),headers:{"Content-Type":"text/plain;charset=utf-8"}})).text();try{return JSON.parse(n)}catch{throw new Error("Server error: "+n.substring(0,100))}}function C(e){u(!1),alert(e.message||"Authentication failed")}function O(){_.classList.remove("hidden"),l.classList.add("hidden"),p&&p.classList.remove("hidden"),a&&a.classList.toggle("hidden",!L)}function x(){_.classList.add("hidden"),l.classList.remove("hidden"),p&&p.classList.add("hidden"),a&&a.classList.add("hidden")}function m(e,t){L=e,w&&w.classList.toggle("hidden",!e),document.querySelectorAll("[data-gsi-button]").forEach(o=>{o.classList.toggle("hidden",e)}),document.querySelectorAll("[data-auth-panel]").forEach(o=>{o.classList.toggle("hidden",e)}),b&&t&&(b.textContent=t)}function B(e){if(!e)return"";const t=e.split(".");if(t.length<2)return"";try{return JSON.parse(atob(t[1].replace(/-/g,"+").replace(/_/g,"/"))).email||""}catch{return""}}function u(e,t){f&&(t&&y&&(y.textContent=t),f.classList.toggle("hidden",!e))}function P(){const e=document.querySelector("[data-taxonomy-list]");!e||!Array.isArray(h)||(e.innerHTML="",h.filter(t=>!t.disabled).forEach(t=>{const o=document.createElement("li"),i=document.createElement("strong");i.textContent=t.label;const n=document.createElement("p");n.textContent=t.description,o.appendChild(i),o.appendChild(n),e.appendChild(o)}))}
