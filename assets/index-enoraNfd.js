(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))r(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function i(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerPolicy&&(o.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?o.credentials="include":t.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(t){if(t.ep)return;t.ep=!0;const o=i(t);fetch(t.href,o)}})();const w="https://script.google.com/macros/s/AKfycbzxY9Q27j0hkv8et8ZnY_Rg639FjD2jtMFFdXyhOZ-EPqH9dCNWjSPUXjISQnTZ8AQ/exec",b="239868878252-db1evisitvh535amajkvubl22kp0jcdm.apps.googleusercontent.com",E="62D8EAC6-9B68-4649-80EF-71FBC18D0D98",p=[{id:"career-professional-development",label:"Career & Professional Development",description:"Support students & other alumni with career decisions, resumes, interviews, leadership, and professional growth."},{id:"technical-domain-expertise",label:"Technical & Domain Expertise",description:"Share engineering, technology, and domain-specific knowledge across core IITB disciplines."},{id:"entrepreneurship-innovation",label:"Entrepreneurship & Innovation",description:"Mentor students and teams on startups, ideas, fundraising, and go-to-market thinking."},{id:"research-academia-support",label:"Research & Academia Support",description:"Guide research methodology, paper reviews, academic writing, guest lectures, and proposal development."},{id:"social-impact-sustainability",label:"Social Impact & Sustainability",description:"Contribute expertise to social entrepreneurship, NGOs, education, and sustainability projects."},{id:"life-skills-mindset",label:"Life Skills & Mindset",description:"Help build critical thinking, decision-making skills, teamwork, and personal resilience."},{id:"program-platform-roles",label:"Program & Platform Roles",description:"Participate as workshop leaders, co-designers of programs, and volunteers supporting TimeBank operations."}];let c=null;const S=document.getElementById("view-landing"),d=document.getElementById("view-app"),v=document.querySelectorAll("[data-gsi-button]"),m=document.getElementById("busy-overlay"),g=document.getElementById("busy-message");document.querySelectorAll("[data-scroll]").forEach(e=>{e.addEventListener("click",n=>{const i=n.currentTarget.getAttribute("data-scroll"),r=document.querySelector(i);r&&r.scrollIntoView({behavior:"smooth"})})});window.handleCredentialResponse=e=>{c=e.credential,sessionStorage.setItem("timebank_token",c),l(!0,"Signing you in…"),u("login_and_fetch_view",{}).then(h).catch(y).finally(()=>l(!1))};a();_();const f=sessionStorage.getItem("timebank_token");f&&(c=f,l(!0,"Loading your dashboard…"),u("login_and_fetch_view",{}).then(h).catch(e=>{sessionStorage.removeItem("timebank_token"),y(e)}).finally(()=>l(!1)));function a(){if(window.google&&google.accounts&&google.accounts.id){google.accounts.id.initialize({client_id:b,callback:handleCredentialResponse,auto_select:!1,use_fedcm_for_prompt:!0}),v.forEach(e=>{google.accounts.id.renderButton(e,{type:"standard",size:"large",width:260,theme:"outline",text:"continue_with",shape:"pill",logo_alignment:"left"})});return}if(a.attempts>30){console.error("Google Identity Services failed to load.");return}a.attempts+=1,setTimeout(a,250)}a.attempts=0;function h(e){if(e.error)throw new Error(e.error);if(!e.html)throw new Error("Missing app view");S.classList.add("hidden"),d.classList.remove("hidden");const n=document.createRange();n.selectNode(document.body);const i=n.createContextualFragment(e.html);d.innerHTML="",d.appendChild(i),window.google=window.google||{},window.google.script={run:{withSuccessHandler:r=>({withFailureHandler:t=>({proxyApiCall:(o,s)=>{u(o,s).then(r).catch(t)}})})}}}async function u(e,n){const i={action:e,sharedKey:E,credential:c,...n},t=await(await fetch(w,{method:"POST",body:JSON.stringify(i),headers:{"Content-Type":"text/plain;charset=utf-8"}})).text();try{return JSON.parse(t)}catch{throw new Error("Server error: "+t.substring(0,100))}}function y(e){l(!1),alert(e.message||"Authentication failed")}function l(e,n){m&&(n&&g&&(g.textContent=n),m.classList.toggle("hidden",!e))}function _(){const e=document.querySelector("[data-taxonomy-list]");!e||!Array.isArray(p)||(e.innerHTML="",p.filter(n=>!n.disabled).forEach(n=>{const i=document.createElement("li"),r=document.createElement("strong");r.textContent=n.label;const t=document.createElement("p");t.textContent=n.description,i.appendChild(r),i.appendChild(t),e.appendChild(i)}))}
