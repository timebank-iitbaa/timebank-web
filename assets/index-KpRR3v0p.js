(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function t(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(o){if(o.ep)return;o.ep=!0;const s=t(o);fetch(o.href,s)}})();const j="https://script.google.com/macros/s/AKfycbzxY9Q27j0hkv8et8ZnY_Rg639FjD2jtMFFdXyhOZ-EPqH9dCNWjSPUXjISQnTZ8AQ/exec",F="239868878252-db1evisitvh535amajkvubl22kp0jcdm.apps.googleusercontent.com",G="62D8EAC6-9B68-4649-80EF-71FBC18D0D98",k=[{id:"career-professional-development",label:"Career & Professional Development",description:"Support students & other alumni with career decisions, resumes, interviews, leadership, and professional growth."},{id:"technical-domain-expertise",label:"Technical & Domain Expertise",description:"Share engineering, technology, and domain-specific knowledge across core IITB disciplines."},{id:"entrepreneurship-innovation",label:"Entrepreneurship & Innovation",description:"Mentor students and teams on startups, ideas, fundraising, and go-to-market thinking."},{id:"research-academia-support",label:"Research & Academia Support",description:"Guide research methodology, paper reviews, academic writing, guest lectures, and proposal development."},{id:"social-impact-sustainability",label:"Social Impact & Sustainability",description:"Contribute expertise to social entrepreneurship, NGOs, education, and sustainability projects."},{id:"life-skills-mindset",label:"Life Skills & Mindset",description:"Help build critical thinking, decision-making skills, teamwork, and personal resilience."},{id:"program-platform-roles",label:"Program & Platform Roles",description:"Participate as workshop leaders, co-designers of programs, and volunteers supporting TimeBank operations."}];let h=null,c=!1;const O=document.getElementById("view-landing"),f=document.getElementById("view-app"),H=document.querySelectorAll("[data-gsi-button]"),A=document.getElementById("busy-overlay"),C=document.getElementById("busy-message"),L=document.querySelector("[data-landing-nav]"),b=document.querySelectorAll("[data-contrib-button]"),w=document.querySelectorAll("[data-contrib-link]"),g=document.querySelector("[data-account-chip]"),_=document.querySelector("[data-account-email]"),R=document.querySelectorAll("[data-signout]"),K=document.querySelectorAll("[data-home]"),x=document.querySelectorAll(".icon-button[data-home]"),d=document.querySelector("[data-signout-icon]"),u=document.querySelector("[data-menu-toggle]"),a=document.querySelector("[data-menu-panel]"),r=document.getElementById("signout-modal"),q=document.querySelector("[data-signout-confirm]"),I=document.querySelector("[data-signout-cancel]"),N=document.querySelectorAll("[data-landing-only]");document.querySelectorAll("[data-scroll]").forEach(e=>{e.addEventListener("click",n=>{const t=n.currentTarget.getAttribute("data-scroll"),i=document.querySelector(t);i&&i.scrollIntoView({behavior:"smooth"})})});K.forEach(e=>{e.addEventListener("click",n=>{n.preventDefault(),m(),M(),window.scrollTo({top:0,behavior:"smooth"})})});b.forEach(e=>{e.addEventListener("click",()=>{m(),E(),window.scrollTo({top:0,behavior:"smooth"})})});w.forEach(e=>{e.addEventListener("click",()=>{E(),window.scrollTo({top:0,behavior:"smooth"})})});u&&a&&(u.addEventListener("click",e=>{e.stopPropagation(),z(),a.classList.toggle("hidden")}),document.addEventListener("click",e=>{!a.classList.contains("hidden")&&!a.contains(e.target)&&e.target!==u&&a.classList.add("hidden")}));R.forEach(e=>{e.addEventListener("click",()=>{r&&r.classList.remove("hidden"),m()})});d&&d.addEventListener("click",()=>{r&&r.classList.remove("hidden")});I&&I.addEventListener("click",()=>{r&&r.classList.add("hidden")});q&&q.addEventListener("click",()=>{r&&r.classList.add("hidden"),h=null,sessionStorage.removeItem("timebank_token"),v(!1),M()});window.handleCredentialResponse=e=>{h=e.credential,sessionStorage.setItem("timebank_token",h),y(!0,"Signing you in…"),S("login_and_fetch_view",{}).then(B).catch(P).finally(()=>y(!1))};p();Y();const T=sessionStorage.getItem("timebank_token");T?(h=T,y(!0,"Loading your dashboard…"),S("login_and_fetch_view",{}).then(B).catch(e=>{sessionStorage.removeItem("timebank_token"),v(!1),P(e)}).finally(()=>y(!1))):v(!1);function p(){if(window.google&&google.accounts&&google.accounts.id){google.accounts.id.initialize({client_id:F,callback:handleCredentialResponse,auto_select:!1,use_fedcm_for_prompt:!0}),H.forEach(e=>{const n=e.dataset.gsiSize||"large",t=e.dataset.gsiText||"continue_with",i=n==="medium"?160:260;google.accounts.id.renderButton(e,{type:"standard",size:n,width:i,theme:"outline",text:t,shape:"pill",logo_alignment:"left"})});return}if(p.attempts>30){console.error("Google Identity Services failed to load.");return}p.attempts+=1,setTimeout(p,250)}p.attempts=0;function B(e){if(e.error)throw new Error(e.error);if(!e.html)throw new Error("Missing app view");const n=document.createRange();n.selectNode(document.body);const t=n.createContextualFragment(e.html);f.innerHTML="",f.appendChild(t);const i=f.querySelector("#user-email");v(!0,i?i.textContent:V(h)),E(),window.google=window.google||{},window.google.script={run:{withSuccessHandler:o=>({withFailureHandler:s=>({proxyApiCall:(l,D)=>{S(l,D).then(o).catch(s)}})})}}}async function S(e,n){const t={action:e,sharedKey:G,credential:h,...n},o=await(await fetch(j,{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"text/plain;charset=utf-8"}})).text();try{return JSON.parse(o)}catch{throw new Error("Server error: "+o.substring(0,100))}}function P(e){y(!1),alert(e.message||"Authentication failed")}function M(){document.body.classList.remove("is-app-view"),O.classList.remove("hidden"),f.classList.add("hidden"),L&&L.classList.remove("hidden"),b.forEach(e=>e.classList.toggle("hidden",!c)),w.forEach(e=>e.classList.toggle("hidden",!c)),N.forEach(e=>e.classList.remove("hidden")),u&&u.classList.remove("hidden"),d&&d.classList.toggle("hidden",!c),x.forEach(e=>e.classList.add("hidden")),g&&g.classList.toggle("hidden",!c)}function E(){document.body.classList.add("is-app-view"),O.classList.add("hidden"),f.classList.remove("hidden"),L&&L.classList.add("hidden"),b.forEach(e=>e.classList.add("hidden")),w.forEach(e=>e.classList.add("hidden")),N.forEach(e=>e.classList.add("hidden")),u&&u.classList.add("hidden"),d&&d.classList.toggle("hidden",!c),x.forEach(e=>e.classList.toggle("hidden",!c)),g&&g.classList.toggle("hidden",!c)}function v(e,n){c=e,g&&g.classList.toggle("hidden",!e),d&&d.classList.toggle("hidden",!e),document.querySelectorAll("[data-gsi-button]").forEach(t=>{t.classList.toggle("hidden",e)}),document.querySelectorAll("[data-auth-panel]").forEach(t=>{t.classList.toggle("hidden",e)}),_&&n&&(_.textContent=n)}function z(){if(!a)return;a.innerHTML="";const e=Array.from(document.querySelectorAll(".site-nav > *")),n=e.find(t=>t.hasAttribute("data-contrib-link"));if(n&&!n.classList.contains("hidden")){const t=n.cloneNode(!0);t.className="menu-item menu-item-strong",t.addEventListener("click",()=>{m(),E(),window.scrollTo({top:0,behavior:"smooth"})}),a.appendChild(t)}if(e.filter(t=>t!==n).forEach(t=>{const i=t.cloneNode(!0);i.className="menu-item",i.addEventListener("click",o=>{const s=i.getAttribute("href");if(s&&s.startsWith("#")){o.preventDefault();const l=document.querySelector(s);l&&l.scrollIntoView({behavior:"smooth"})}m()}),a.appendChild(i)}),c){const t=document.createElement("button");t.type="button",t.className="menu-item menu-item-logout",t.textContent="Sign out",t.addEventListener("click",()=>{r&&r.classList.remove("hidden"),m()}),a.appendChild(t)}}function m(){a&&!a.classList.contains("hidden")&&a.classList.add("hidden")}function V(e){if(!e)return"";const n=e.split(".");if(n.length<2)return"";try{return JSON.parse(atob(n[1].replace(/-/g,"+").replace(/_/g,"/"))).email||""}catch{return""}}function y(e,n){A&&(n&&C&&(C.textContent=n),A.classList.toggle("hidden",!e))}function Y(){const e=document.querySelector("[data-taxonomy-list]");!e||!Array.isArray(k)||(e.innerHTML="",k.filter(n=>!n.disabled).forEach(n=>{const t=document.createElement("li"),i=document.createElement("strong");i.textContent=n.label;const o=document.createElement("p");o.textContent=n.description,t.appendChild(i),t.appendChild(o),e.appendChild(t)}))}
